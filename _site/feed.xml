<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>JDStraughan</title>
    <description>JDStraughan. Blog of Web Developer, Rubyist, and Entrepreneur Jason D. Straughan. Founder and CEO of Grok Interactive and Co-Founder of Codeup.</description>
    <link>http://jdstraughan.com/</link>
    <atom:link href="http://jdstraughan.com/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Sat, 23 May 2015 22:37:19 -0500</pubDate>
    <lastBuildDate>Sat, 23 May 2015 22:37:19 -0500</lastBuildDate>
    <generator>Jekyll v2.5.3</generator>
    
      <item>
        <title>It&#39;s a Great Big Beautiful Tomorrowland</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;THIS POST DISCUSSES THE NEW MOVIE BUT TRIES TO AVOID SPOILERS. There is mention of scenes, but nothing that cannot be recognized from the trailer or in the opening credits.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Everyone that knows me knows I am a &lt;a href=&quot;http://www.urbandictionary.com/define.php?term=disneyphile&quot;&gt;Disneyphile&lt;/a&gt;. Specifically, I am in love with the Disney Parks experience. My family makes an average of two treks per year to a Disney property, mainly Walt Disney World in Orland, Florida. It should come as no surprise that we were excited to view the new Disney motion picture &lt;em&gt;Tomorrowland&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;For the uninitiated, &lt;a href=&quot;http://en.wikipedia.org/wiki/Tomorrowland&quot;&gt;Tomorrowland&lt;/a&gt; is the name for one of the themed land in each of the Disney Parks that showcases futuristic attractions, most notably  &lt;a href=&quot;http://en.wikipedia.org/wiki/Space_Mountain&quot;&gt;Space Mountain&lt;/a&gt;. (In Disneyland Paris it is called &lt;a href=&quot;http://disney.wikia.com/wiki/Discoveryland&quot;&gt;Discoveryland&lt;/a&gt;, with a Jules Verne steam-punk influence, and in Shanghai there is not a Space Mountain, rather an indoor TRON roller-coaster.)&lt;/p&gt;

&lt;p&gt;While aimed at general audiences, the picture certainly rewards Disney lovers with countless &lt;a href=&quot;http://en.wikipedia.org/wiki/Easter_egg_%28media%29&quot;&gt;easter eggs&lt;/a&gt; and references to all things Disney. We start by seeing the standard castle in the Disney logo replaced with a skyline of Tomorrowland. The iconic Space Mountain building is the first thing I noticed, and it makes several appearances throughout the film.&lt;/p&gt;

&lt;p&gt;Shortly after the restyled logo, we are presented with &lt;em&gt;A113 Productions&lt;/em&gt;. Every Disney or Pixar junkie will immediately notice this reference to the animation classroom at the &lt;a href=&quot;http://en.wikipedia.org/wiki/California_Institute_of_the_Arts&quot;&gt;California Institute of the Arts&lt;/a&gt;. &lt;a href=&quot;http://en.wikipedia.org/wiki/A113&quot;&gt;A113&lt;/a&gt; is added as an easter egg in many animations, Disney pictures, and every Pixar movie. Many animators at Disney have studied in that room, including &lt;a href=&quot;http://en.wikipedia.org/wiki/John_Lasseter&quot;&gt;John Lasseter&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/Tim_Burton&quot;&gt;Tim Burton&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/Brad_Bird&quot;&gt;Brad Bird&lt;/a&gt; and many others. Walt Disney himself has a very strong connection to CalArts; he was the founder and left most of his fortune to the school.&lt;/p&gt;

&lt;p&gt;When the movie starts, we are at the &lt;a href=&quot;http://en.wikipedia.org/wiki/1964_New_York_World%27s_Fair&quot;&gt;1964 New York World’s Fair&lt;/a&gt;. Shots of the facade for &lt;a href=&quot;http://en.wikipedia.org/wiki/It%27s_a_Small_World&quot;&gt;&lt;em&gt;It’s a Small World&lt;/em&gt;&lt;/a&gt; are met with the theme song for &lt;a href=&quot;http://en.wikipedia.org/wiki/Walt_Disney%27s_Carousel_of_Progress&quot;&gt;&lt;em&gt;Carousel of Progress&lt;/em&gt;&lt;/a&gt;. Both of these attractions debuted at the fair, and are both staples of any Disney trip (although you must go to Florida to see Carousel of Progress).&lt;/p&gt;

&lt;p&gt;At the Disney Parks, you can trade &lt;a href=&quot;http://disney.go.com/eventservices/whatispintrading.html&quot;&gt;official Disney pins&lt;/a&gt; with cast-members. While there are a plethora of pins for purchase, the most sought-after pins can only be obtained by trading with a cast-member, or with someone who has. The Tomorrowland pins have a special meaning in this movie, making yet another wonderful connection to the park experience.&lt;/p&gt;

&lt;p&gt;Prior to Tomorrowland, director Brad Bird brought us &lt;em&gt;The Iron Giant&lt;/em&gt;, and Disney flicks &lt;em&gt;The Incredibles&lt;/em&gt; and &lt;em&gt;Ratatouille&lt;/em&gt;. Both the Iron Giant and Mr. Incredible make appearances in Tomorrowland, along with another Pixar creation: the evil Emperor Zurg. You can also find references to &lt;em&gt;Star Wars&lt;/em&gt;, &lt;em&gt;The Black Hole&lt;/em&gt;, and countless other sci-fi throwbacks in one scene.&lt;/p&gt;

&lt;p&gt;I will be very surprised if there are not other hidden treasures common to Disney and Pixar movies, specifically &lt;a href=&quot;http://en.wikipedia.org/wiki/Hidden_Mickey&quot;&gt;hidden Mickeys&lt;/a&gt;, the &lt;a href=&quot;http://en.wikipedia.org/wiki/List_of_Pixar_film_references#Luxo_Ball&quot;&gt;Luxo Ball&lt;/a&gt;, and other canon. I was not able to find any of these easter eggs on my first viewing in the theater, however, I will be paying close attention when it finally arrives for home viewing.&lt;/p&gt;

&lt;p&gt;My favorite part of the movie is the optimism of a brighter future. On every visit to Walt Disney World there are two attractions I must ride: &lt;em&gt;The Carousel of Progress&lt;/em&gt; and &lt;a href=&quot;http://en.wikipedia.org/wiki/Spaceship_Earth_(Epcot)&quot;&gt;&lt;em&gt;Spaceship Earth&lt;/em&gt;&lt;/a&gt;. Both of these rides leave me feeling with unbelievable optimism in my fellow man, and the wonderments that our progress has created.&lt;/p&gt;

&lt;p&gt;Like those rides, this movie leaves dystopia behind and greets us with the warm embrace of the feature. Don’t get left behind, they saved a seat just for you.&lt;/p&gt;

</description>
        <pubDate>Sat, 23 May 2015 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2015/05/23/its-a-great-big-beautiful-tomorrowland</link>
        <guid isPermaLink="true">http://jdstraughan.com/2015/05/23/its-a-great-big-beautiful-tomorrowland</guid>
        
        <category>Disney</category>
        
        <category>future</category>
        
        
      </item>
    
      <item>
        <title>3 Day Startup San Antonio at Geekdom (Summer 2013)</title>
        <description>&lt;p&gt;This past weekend I was fortunate enough to participate in the &lt;a href=&quot;http://3dssanantonio.com/&quot;&gt;3 Day Startup San Antonio&lt;/a&gt; event at &lt;a href=&quot;http://geekdom.com/&quot;&gt;Geekdom&lt;/a&gt; as a mentor.  If you are not familiar with 3 Day Startup (3DS), the website offers this description:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The idea of 3 Day Startup is simple: start a company over the course of three days. We rent work space for an entire weekend, recruit 40 students and young professionals with a wide range of backgrounds, cater food and drinks, invite top-notch entrepreneurs and investors, pick the best idea for a software startup during the Friday brainstorming session, and release a minimal prototype by Sunday night. The goal is to build enough momentum among a network of motivated people to sustain the company beyond the weekend.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The program embraces the &lt;a href=&quot;http://en.wikipedia.org/wiki/Lean_Startup&quot;&gt;lean startup&lt;/a&gt; methodology to engage customers along the product development lifecycle to properly align the company’s offerings with the customer’s needs.  Using the &lt;a href=&quot;http://leanstack.com/&quot;&gt;lean canvas&lt;/a&gt; as a guide map, teams are challenged to identify a problem, propose a solution, engage in customer development, pivot as necessary, and emerge with a prototype that can be pitched to a panel of investors.&lt;/p&gt;

&lt;p&gt;On the first day, participants were broken into groups where they brainstormed ideas for problems and solutions that could be prototyped in 72 hours or less. They voted on a subset of these ideas, and the idea originators began recruiting talent to join their company for the weekend.  Then the teams organize and begin the first draft of their lean canvases.&lt;/p&gt;

&lt;p&gt;After spending Friday night determining their problem, unique value proposition, potential customers, potential solutions, and filling out the rest of the lean canvas worksheet, Saturday starts off with a presentation on customer development.  Then the participants are asked to leave the building, and actually go out into the world in search of potential customers to interview.&lt;/p&gt;

&lt;p&gt;Much like performing experiments in a chemistry lab to determined the plausibility of a theory, the teams used real potential customers to help them determine the validity of their problem, and find out if their solution was the right fit.  By learning more about the actual customer needs in the domain, the teams could make more informed decisions about how their company was going to move forward.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;example-lean-canvas&quot;&gt;Example Lean Canvas&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/cornholio_lean_canvas_example.png&quot; alt=&quot;Lean Canvas Example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This lean canvas for a fictitious startup, &lt;a href=&quot;http://cornhol.io&quot;&gt;cornhol.io&lt;/a&gt;, was created using the &lt;a href=&quot;https://drive.google.com/previewtemplate?id=16uOd158UzJM9oqGWgJOtbppzGNPmZ4fWMSV6_xBz3Z8&amp;amp;mode=public&amp;amp;pli=1#&quot;&gt;Lean Canvas Google Docs Template&lt;/a&gt; by &lt;a href=&quot;https://drive.google.com/templates?view=public&amp;amp;authorId=11994523493363598636&quot;&gt;Lucas Rodriguez Cervera&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;By Saturday afternoon, most teams had realized they were going to need to make some adjustments to properly align themselves with their target market.  For some teams this meant changing their solution, others had to adjust the problem as well, while some teams had to find new problems to solve altogether.  Much like in a real business, adaptation is requisite to survival.&lt;/p&gt;

&lt;p&gt;Teams worked late into the night on Saturday, rounding out their lean canvases, making the necessary changes to stay relevant to their demographic.  They began to analyze revenue streams, customer acquisition funnels, discuss product details, and start thinking about what a prototype was going to look like.&lt;/p&gt;

&lt;p&gt;Sunday morning started off with breakfast presentation on how to pitch to investors.  Examples were shown, dos and don’ts were advised, and the teams were sent back to their rooms to work on their pitches, with first drafts being given to the entire group over lunch. Slide decks began to came together, presenters were picked from each group, and each company had their first opportunity to show off their new product or service.&lt;/p&gt;

&lt;p&gt;After having a chance to practice their first draft pitches to the group, and eating lunch watching the other groups in turn, teams scrambled to make the adjustments needed to bring their ideas to life.&lt;/p&gt;

&lt;p&gt;It’s crunch-time.  In mere hours each team will go before potential investors, family, friends, and members of the business community to pitch their companies, and answer questions from our panel of experts.  Their stories are tightened up, the slides are scrutinized, rearranged, and reordered.  The presenter practices over and over, perfecting each idea, sentence, word.&lt;/p&gt;

&lt;p&gt;Then it happens.  One by one, the teams present their idea, pitching to live people.  The panelists ask questions, prod for deeper understanding, and try to determine the viability of the ideas and teams.&lt;/p&gt;

&lt;p&gt;An important lesson I learned from 3DS: the idea is the vehicle needed to learn the process. While some ideas are better than others, it is customer interviews that hammer these ideas into viable business candidates.  Tenacity is often the deciding factor in a team’s success.  Mentors give advice, customers give feedback, but ultimately it is the teams that must make the hard decisions, assemble a solution, and stand by it during the final presentation.&lt;/p&gt;

&lt;p&gt;This was my first experience with 3DS and I was thankful to be paired with seasoned mentors; entrepreneurs that had one or more 3DS weekend under their belt.  I’m confident I learned just as much as the participants, maybe more. I was very impressed with the teams and their accomplishments in such a short amount of time, and hope to stay in contact with many participants for years to come.  The lessons, people, and inspiration will have long-term effects on my professional and personal life.&lt;/p&gt;

&lt;p&gt;A special thanks to the 3DS organizers: &lt;a href=&quot;http://girdley.com/&quot;&gt;Michael Girdley&lt;/a&gt;, &lt;a href=&quot;http://www.ryantanner.org/&quot;&gt;Ryan Tanner&lt;/a&gt;, and &lt;a href=&quot;http://venturelab.net/about/our-team/&quot;&gt;Luz Cristal Glangchai&lt;/a&gt; for making this happen, and giving me the opportunity to participate.&lt;/p&gt;

&lt;p&gt;Below you’ll find links to the final pitches, and an interview with some of the mentors (including myself).&lt;/p&gt;

&lt;h3 id=&quot;final-pitches&quot;&gt;Final Pitches&lt;/h3&gt;

&lt;iframe width=&quot;640&quot; height=&quot;385&quot; src=&quot;http://cdn.livestream.com/embed/3dssasummer?layout=4&amp;amp;clip=flv_8840c91a-53b8-4694-aee4-5792e03f2d05&amp;amp;color=0xe7e7e7&amp;amp;autoPlay=false&amp;amp;mute=false&amp;amp;iconColorOver=0x888888&amp;amp;iconColor=0x777777&amp;amp;allowchat=true&amp;amp;height=385&amp;amp;width=640&quot; style=&quot;border:0;outline:0&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;

&lt;h3 id=&quot;interviews&quot;&gt;Interviews&lt;/h3&gt;

&lt;iframe width=&quot;640&quot; height=&quot;385&quot; src=&quot;http://cdn.livestream.com/embed/3dssasummer?layout=4&amp;amp;clip=flv_fe20f99d-dbbb-4e4c-a30e-d7534c82d0f8&amp;amp;color=0xe7e7e7&amp;amp;autoPlay=false&amp;amp;mute=false&amp;amp;iconColorOver=0x888888&amp;amp;iconColor=0x777777&amp;amp;allowchat=true&amp;amp;height=385&amp;amp;width=640&quot; style=&quot;border:0;outline:0&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;

&lt;iframe width=&quot;640&quot; height=&quot;385&quot; src=&quot;http://cdn.livestream.com/embed/3dssasummer?layout=4&amp;amp;clip=flv_52c129ee-39e1-4259-bfaa-b88def9e3d5a&amp;amp;color=0xe7e7e7&amp;amp;autoPlay=false&amp;amp;mute=false&amp;amp;iconColorOver=0x888888&amp;amp;iconColor=0x777777&amp;amp;allowchat=true&amp;amp;height=385&amp;amp;width=640&quot; style=&quot;border:0;outline:0&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;
</description>
        <pubDate>Wed, 14 Aug 2013 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2013/08/14/3-Day-Startup-San-Antonio-at-Geekdom-2013</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/08/14/3-Day-Startup-San-Antonio-at-Geekdom-2013</guid>
        
        
      </item>
    
      <item>
        <title>Introduction to Graph Databases using Neo4j</title>
        <description>&lt;p&gt;At just that moment when I was convinced the social networking revolution was no more enlightening than reality television, I began to realize that there was one great and powerful idea that needed this exact environment to gestate: the graph database. From Facebook’s Graph Search, to LinkedIn’s connection recommendations, graph databases are shaping the world around us.  Although graph theory has been around for centuries, its penchant for highly-related datasets makes it an attractive alternative to traditional RDBMS solutions in some situations.&lt;/p&gt;

&lt;h3 id=&quot;what-is-a-graph-database&quot;&gt;What is a graph database?&lt;/h3&gt;

&lt;p&gt;For those that are unfamiliar with graph databases, they do not store graphs in the chart sense, but rather &lt;a href=&quot;http://en.wikipedia.org/wiki/Graph_(abstract_data_type)&quot;&gt;graph structures&lt;/a&gt;. The three moving parts are nodes, properties, and relationships (edges).  These can be visualized nicely in this image from wikimedia:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/commons/3/3a/GraphDatabase_PropertyGraph.png&quot; alt=&quot;graph example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Just by looking at this first example, we can see that even representing a graph looks much different than the tables with relationship arrows that are generally associated with visualizing relational databases.&lt;/p&gt;

&lt;p&gt;The circles in this diagram are referred to as &lt;strong&gt;nodes&lt;/strong&gt;. Each node has an identifier, and then a set of &lt;strong&gt;properties&lt;/strong&gt; represented as key/value pairs. Further inspection of these nodes reveal they are schemaless, with 2 of the nodes containing name and age properties, and one of the nodes containing type and name properties.  This is common in other NoSQL databases, so we’ve not seen anything unique so far.&lt;/p&gt;

&lt;p&gt;Next we can see the arrow pointing from one node to another.  These arrows are &lt;strong&gt;relationships&lt;/strong&gt; between the nodes.  Relating database records is common in both the NoSQL and SQL worlds. In our graph example, the astute observer would notice these relationships also have properties that are represented as key/value pairs.  Like their node counterparts, they are also schemaless, allowing arbitrary keys on different relationships.  It is worth noting, in the graph world, these relationships are referred to as &lt;strong&gt;edges&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;why-use-a-graph-database&quot;&gt;Why use a graph database?&lt;/h3&gt;

&lt;p&gt;The most often use case given as an example for graphs is social networking.  This is also the arena that has (re)introduced graph structures to developers, however, graphs also offer a solution for modeling other data, and can be a powerful tool for recommendations, ratings, and highly interconnected data.&lt;/p&gt;

&lt;p&gt;Once we begin to understand how the graph works, we can begin to see uses for it everywhere.  Imagine dungeon games, where map locations, guild relationships, and other related data lives in a graph structure.  Family trees also come to mind, where you can traverse a &lt;a href=&quot;http://en.wikipedia.org/wiki/Tree_(data_structure)&quot;&gt;tree shaped graph&lt;/a&gt; to learn more about one’s heritage.&lt;/p&gt;

&lt;p&gt;Traversal is the way we &lt;em&gt;walk&lt;/em&gt; graph structures, and in a tree shaped result, it is referred to as &lt;a href=&quot;http://en.wikipedia.org/wiki/Tree_(data_structure)#Traversal_methods&quot;&gt;walking the tree&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;walking-trees-and-other-fun-shapes&quot;&gt;Walking trees (and other fun shapes)&lt;/h3&gt;

&lt;p&gt;Traversal is simply the process of working from one node to the next, using relationships, based on whatever parameters have been established. &lt;a href=&quot;http://en.wikipedia.org/wiki/Tree_traversal&quot;&gt;Tree traversal&lt;/a&gt; is more complex than &lt;em&gt;walking&lt;/em&gt; a linear path, like steps 1 - 5, that can easily be visited in order.  With a tree shaped data structure, you can choose paths to visit every node, or find paths based on other criteria to return subsets of the total structure.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Sorted_binary_tree_inorder.svg/336px-Sorted_binary_tree_inorder.svg.png&quot; alt=&quot;example of tree graph&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is an example of a binary tree, being traversed in order.  Following the dotted line, we can see how the tree is traversed, or walked, to get all the nodes along the edges.&lt;/p&gt;

&lt;p&gt;Shapes refer to named structures found in graphs.  Most are named after the way they look when visualized.  Popular &lt;em&gt;shapes&lt;/em&gt; include trees, stars, wheels, and &lt;a href=&quot;http://en.wikipedia.org/wiki/Gallery_of_named_graphs&quot;&gt;many others&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/commons/7/7d/Star_graphs.svg&quot; alt=&quot;example of star graph&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A &lt;a href=&quot;http://en.wikipedia.org/wiki/Star_(graph_theory)&quot;&gt;star graph&lt;/a&gt; shows one node, with all the nodes directly connected to it via an edge (relationship).&lt;/p&gt;

&lt;p&gt;Now that we’ve reviewed the basics of graphs and their structures, lets take a look at using them in an actual database.&lt;/p&gt;

&lt;h3 id=&quot;introducing-neo4j&quot;&gt;Introducing neo4j&lt;/h3&gt;

&lt;p&gt;There are several graph databases available to choose from, but the one I’ve worked with, and seems to have the most popularity right now, is neo4j. Neo4j’s API can be accessed via Java, JPython, JRuby, PHP, .NET, Clojure, and REST.  There are several choices for querying neo4j, with cypher, neo4j’s query language, being the most prominent. Neo4j ships with a data browser, uses ACID transactions, and scales via replication.  For a more in depth view, I’d encourage &lt;a href=&quot;http://www.neo4j.org/&quot;&gt;visiting their website&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;learning-neo4j&quot;&gt;Learning neo4j&lt;/h4&gt;

&lt;p&gt;The neo4j team and community have done a great job of supplying educational material and &lt;a href=&quot;http://www.neo4j.org/develop/example_data&quot;&gt;sample datasets&lt;/a&gt; for exploration. At the time of this blog post, they are even giving away a &lt;a href=&quot;http://www.neo4j.org/learn&quot;&gt;free copy of O’Reilly’s new book: Graph Databases&lt;/a&gt;.  The &lt;a href=&quot;http://www.neo4j.org/learn/videos&quot;&gt;video section&lt;/a&gt; of their site is very informative, with the &lt;a href=&quot;http://www.neo4j.org/learn/videos_webinar&quot;&gt;webinars&lt;/a&gt; particularly useful.&lt;/p&gt;

&lt;h4 id=&quot;querying-with-cypher&quot;&gt;Querying with Cypher&lt;/h4&gt;

&lt;p&gt;The cypher query language is unique to neo4j, and while it is very different than other database query languages, I have found it to be quite expressive and easy to use.  The basics are simple: each query has a start, a match, and a return.  Traversing a graph requires knowing where you want to begin (the start node), the rules that will allow traversal (the match segment) and what data you are expecting back (the return).&lt;/p&gt;

&lt;p&gt;A simple cypher query looks something like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START n
MATCH n-[r]-m
RETURN r;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Before we can show an actual query that retrieves data, we need to load some nodes and relationships into our graph.&lt;/p&gt;

&lt;p&gt;Creating new nodes and relationships are also fairly straightforward. To create the graph example we’ve used above in neo4j (version 1.9) using cypher, we would need the following queries to create the nodes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CREATE (n { name : &#39;Alice&#39; , age : 18 });
CREATE (n { name : &#39;Bob&#39; , age : 22 });
CREATE (n { type : &#39;Group&#39; , name : &#39;Chess&#39; });
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These 3 queries each create a new node with properties.  The first 2 create people, the last one creates the “Chess” group.  Each query would also assign an internal ID to each node.&lt;/p&gt;

&lt;p&gt;Given the knowledge that Bob’s node has an ID of 1, and Alice has an ID of 2, we can use these queries to create the relationships:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START alice = node(1), bob = node(2)
CREATE alice-[r:KNOWS { since:&quot;2001/10/03&quot;}]-&amp;gt;bob
RETURN r;

START alice = node(1), bob = node(2)
CREATE bob-[r:KNOWS { since:&quot;2001/10/04&quot;}]-&amp;gt;alice
RETURN r;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here we see 2 relationships defined: one from Alice to Bob, and another that relates Bob to Alice.  In neo4j relationships are unidirectional, so to represent the graph as described in our example image above, we needed to create 2 relationships.&lt;/p&gt;

&lt;p&gt;Given that the group Chess has a node ID of 3, we can relate Bob and Alice to the Chess group as follows:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START alice = node(1), chess_group = node(3)
CREATE alice-[r:IS_MEMBER { since:&quot;2005/7/1&quot;}]-&amp;gt;chess_group
RETURN r;

START alice = node(1), chess_group = node(3)
CREATE chess_group-[r:MEMBERS]-&amp;gt;alice
RETURN r;

START bob = node(2), chess_group = node(3)
CREATE bob-[r:IS_MEMBER { since:&quot;2011/2/14&quot;}]-&amp;gt;chess_group
RETURN r;

START bob = node(2), chess_group = node(3)
CREATE chess_group-[r:MEMBERS]-&amp;gt;bob
RETURN r;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Again, we created on directional relationship from Bob and Alice to the group, and another back from the group for each member.&lt;/p&gt;

&lt;p&gt;It is possible to create nodes and relationships in a single query.  For example, if we wanted to add a node for Joe, aged 19, and relate him as a friend of Alice starting on 2013/7/1, we could do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START alice=node(1)
CREATE p = (n {name:&#39;Joe&#39;, age: 19})-[:KNOWS {since:&quot;2013/7/1&quot;}]-&amp;gt;alice
RETURN p;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now that we’ve loaded some data into our graph, let’s see what it takes to get some results back from some queries.&lt;/p&gt;

&lt;p&gt;Using our example graph from above, if we wanted to know who Bob knows, we could ask:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START bob=node(2) MATCH bob-[r:KNOWS]-&amp;gt;m RETURN m.name;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Neo4j will reply:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;+---------+
| m.name  |
+---------+
| &quot;Alice&quot; |
+---------+
1 row
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If we wanted to know the members of our Chess group, we could query:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START chess_group=node(3) MATCH chess_group-[r:MEMBERS]-&amp;gt;m RETURN m.name;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Which returns:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;+---------+
| m.name  |
+---------+
| &quot;Bob&quot;   |
| &quot;Alice&quot; |
+---------+
2 rows
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;While these examples are fairly simple, the larger the dataset becomes, the more complex queries you can make.  There are also methods to help you find things like the shortest path between nodes, etc.&lt;/p&gt;

&lt;p&gt;You can &lt;a href=&quot;http://www.neo4j.org/learn/try&quot;&gt;try cypher live on real data&lt;/a&gt; via the neo4j website.  The web interface is very nice for playing with existing datasets, or creating your own.&lt;/p&gt;

&lt;h3 id=&quot;beyond-bob-and-alice&quot;&gt;Beyond Bob and Alice&lt;/h3&gt;

&lt;p&gt;Looking at social graphs with Bob and Alice is fun and all, but the real world is a bit more interesting that 2 folks and a chess club.  To really our hands dirty using graphs, lets explore something a bit more real.&lt;/p&gt;

&lt;h3 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;While graph databases are not the silver bullet for all our data needs, they do offer a unique way of modeling data that is highly interconnected.  For web developers, the possibilities for graphs in web applications is almost endless.&lt;/p&gt;

&lt;p&gt;Neo4j is as good as a place as any to start learning about these data stores. With a robust API, active community, and the expressiveness of the cypher query language, I look forward to continuing developing web applications backed by graph databases for years to come.&lt;/p&gt;
</description>
        <pubDate>Mon, 01 Jul 2013 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2013/07/01/neo4j-or-how-I-learned-to-stop-worrying-and-love-the-graph</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/07/01/neo4j-or-how-I-learned-to-stop-worrying-and-love-the-graph</guid>
        
        <category>neo4j</category>
        
        <category>database</category>
        
        <category>graph</category>
        
        
      </item>
    
      <item>
        <title>The day the music went blind</title>
        <description>&lt;p&gt;The soundtrack of my youth was illustrated by &lt;a href=&quot;http://en.wikipedia.org/wiki/Storm_Thorgerson&quot;&gt;Storm Thorgerson&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I cannot listen to &lt;em&gt;Darkside of the Moon&lt;/em&gt; without seeing the prism. Just one bar of &lt;em&gt;Wish You Were Here&lt;/em&gt; conjures visions of the burning man.  The same is true with &lt;em&gt;Animals&lt;/em&gt;, &lt;em&gt;Atom Heart Mother&lt;/em&gt;, and non-Floyd greats by bands like Led Zeppelin, Black Sabbath, Alan Parsons, Phish, and many, many others.&lt;/p&gt;

&lt;p&gt;When I hear the tunes, I see the album art.&lt;/p&gt;

&lt;p&gt;Storm’s art.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/en/3/3b/Dark_Side_of_the_Moon.png&quot; alt=&quot;Darkside of the Moon&quot; /&gt;
&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/en/3/39/WishYouWereHere-300.jpg&quot; alt=&quot;Wish You Were Here&quot; /&gt;
&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/en/2/2e/AtomHeartMotherCover.jpeg&quot; alt=&quot;Atom Heart Mother&quot; /&gt;
&lt;img src=&quot;http://upload.wikimedia.org/wikipedia/en/7/74/Pink_Floyd-Animals-Frontal.jpg&quot; alt=&quot;Animals&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Music stores are the galleries that display his work.  The images fill our iTunes libraries with art that reminds us of what we were doing the first time we listened to these iconic albums.&lt;/p&gt;

&lt;p&gt;Storm died today.&lt;/p&gt;

&lt;p&gt;A part of the music died with him.&lt;/p&gt;
</description>
        <pubDate>Thu, 18 Apr 2013 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2013/04/18/the-day-the-music-went-blind</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/04/18/the-day-the-music-went-blind</guid>
        
        <category>general</category>
        
        
      </item>
    
      <item>
        <title>Darth Vader Dreams of Electric Sheep</title>
        <description>&lt;p&gt;My 7 year old son received a fake flip-phone style hand-held game, a cheap knockoff that will not last a week, as part of his Easter weekend prize haul.  He promptly held it up to his ear, and proclaimed “Look, it’s an old-timey phone”.&lt;/p&gt;

&lt;p&gt;Flip phones are “old-timey”?&lt;/p&gt;

&lt;p&gt;I’m not yet forty years old, and a once coveted piece of advanced cellular technology is now considered old-timey. He’s never heard a busy signal, and I doubt he’d recognize a dial-tone.  Phones don’t ring for his generation, they play songs and show videos.  In my lifetime, the flip phone represented everything good about electronics, and for many years elevated the social status of the owner.  Until it was  unseated by the smartphone, the flip-phone was king.&lt;/p&gt;

&lt;p&gt;Now, it is old-timey.  The world has moved on.&lt;/p&gt;

&lt;p&gt;The world was boring when I was a kid, all the cool things happened in my parent’s lifetime.  Or so I thought.  Now we live in a new era, and I have watched mankind peek through the crack as a door opens that will change everything.&lt;/p&gt;

&lt;p&gt;My son will grow up in this new world.  I don’t mean one that lacks busy signals and where long-distance calls don’t exist.  I’m talking about a world where everything is possible.&lt;/p&gt;

&lt;p&gt;Our neighbor planet is inhabited entirely by robots. Think about that for a second. My parents would have considered that science-fiction as kids. We have spent billions of dollars colonizing Mars with machines that have taken up residence there, and phone home with their ever expanding knowledge.  The Kardashians get more airtime, but NASA, JPL, and various other groups are working on things that make fact out of science fiction.&lt;/p&gt;

&lt;p&gt;We have a robot vacuum cleaner, my son calls it Barry.&lt;/p&gt;

&lt;p&gt;We know people that would no longer be living if we did not put machines in their body. Move over Darth Vader, everyone we know with a pacemaker is a part of my son’s life because of the advances in technology, and the innovation of countless surgeons, scientists, and patients. His generation will expect a lot from the medical community, and they’ll probably get it.&lt;/p&gt;

&lt;p&gt;Knowledge brings freedom to mankind.  The more knowledge we have, the more free we become.&lt;/p&gt;

&lt;p&gt;I remember my folks kept maps in the car. If we were lost in the city, we could pull over, get out the map, and plot out a route home. The information in the maps made it easier to navigate the confusing city streets. My kid asks Siri where the nearest pizza place is, and my car radio begins giving me friendly, turn-by-turn directions.&lt;/p&gt;

&lt;p&gt;The replacement for the flip-phone does more than make calls.&lt;/p&gt;

&lt;p&gt;I can read news about a bombing of a disco in Jerusalem from multiple sources, and have them all translated to my native language.&lt;/p&gt;

&lt;p&gt;I can take a math course from MIT, and a programming course from Stanford, at the same time, for free, while eating cold spaghetti in my underwear.&lt;/p&gt;

&lt;p&gt;I can take a video of my kid meeting Mickey Mouse, and grandma can watch it minutes later.&lt;/p&gt;

&lt;p&gt;Facebook knows my every move.&lt;/p&gt;

&lt;p&gt;In our pockets we carry all the knowledge of mankind, the ability to communicate with people worldwide.&lt;/p&gt;

&lt;p&gt;We have instant &lt;em&gt;everything&lt;/em&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“With great power must also come… great responsibility” - &lt;a href=&quot;http://en.wikiquote.org/wiki/Stan_Lee&quot;&gt;Stan Lee&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;We’re colonizing planets with robots, putting computers in hearts, Legos are object oriented, and printers output in 3D.&lt;/p&gt;

&lt;p&gt;I’ve seen the future, and it &lt;em&gt;rocks&lt;/em&gt;.  The engineers of tomorrow will shape it into the most amazing wonders our species have ever seen, and we may be lucky enough to see it.&lt;/p&gt;

&lt;p&gt;Our kids will see more than we will.&lt;/p&gt;

&lt;p&gt;Someday, I hope to have a grandchild.  A very smart one, one that questions everything and has an insatiable desire for learning.  He’ll ask my son about everything, and expect good answers.  He’ll call something we have yet to discover archaic, my son will think himself an old man, and I’ll smile.&lt;/p&gt;

&lt;p&gt;I’m excited to see what the next things are.  What we create, what we learn, where we go, and how we get there. If we set the sights of our children on science, we’ll all live in a better place.&lt;/p&gt;

&lt;p&gt;A place where smartphones are old-timey.&lt;/p&gt;
</description>
        <pubDate>Sun, 31 Mar 2013 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2013/03/31/darth-vader-dreams-of-electric-sheep</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/03/31/darth-vader-dreams-of-electric-sheep</guid>
        
        <category>general</category>
        
        
      </item>
    
      <item>
        <title>Homemade Ginger Ale that is so easy (even a 7 year old can do it)</title>
        <description>&lt;p&gt;For the past couple of years, I’ve enjoyed finding craft sodas, and my son has developed quite the palette for fine root beers.  While ginger beer (or ginger ale as some call it) is not his favorite, his mom and I sure think it is nice.&lt;/p&gt;

&lt;p&gt;While surfing around the internet, I decided to see what it would take to brew our very own ginger beer from scratch.  I found plenty of recipes and techniques, and finally settled on something in between &lt;a href=&quot;http://www.foodnetwork.com/recipes/alton-brown/ginger-ale-recipe/index.html&quot;&gt;Alton Brown’s Ginger Ale&lt;/a&gt; and &lt;a href=&quot;http://biology.clc.uc.edu/fankhauser/cheese/ginger_ale_ag0.htm&quot;&gt;a chemist in Ohio’s recipe&lt;/a&gt;.  While both recipes are very similar, I still felt it necessary to make some minor changes.&lt;/p&gt;

&lt;p&gt;In the end our first attempt at &lt;em&gt;Straughan’s World Famous Ginger Beer&lt;/em&gt; was a success, and is now open-source.&lt;/p&gt;

&lt;h3 id=&quot;dependencies&quot;&gt;Dependencies&lt;/h3&gt;

&lt;p&gt;You will need the following ingredients&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;2 Liters of filtered water (not chlorinated stuff from tap)&lt;/li&gt;
  &lt;li&gt;1 Lemon (juiced)&lt;/li&gt;
  &lt;li&gt;1 1/2 Tbl Ground fresh ginger root&lt;/li&gt;
  &lt;li&gt;3/4 C Sugar&lt;/li&gt;
  &lt;li&gt;1/4 C Local Honey&lt;/li&gt;
  &lt;li&gt;1/8 tsp champagne yeast&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/ingredients-portrait.jpg&quot; alt=&quot;Ingredients Portrait&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You will also need a 2 liter bottle, sanitizer, and a refrigerator.  7 year old kid is optional.&lt;/p&gt;

&lt;h3 id=&quot;construction&quot;&gt;Construction&lt;/h3&gt;

&lt;p&gt;The entire project will be built inside the 2 liter bottle, so everything is simple.  I also took a lot of pictures so I did not have to type much for this post.&lt;/p&gt;

&lt;p&gt;I did not take photos of the sanitization process.  I used &lt;a href=&quot;http://www.austinhomebrew.com/product_info.php?products_id=11166&quot;&gt;BrewVint Cleanitizer&lt;/a&gt; from a &lt;a href=&quot;http://www.austinhomebrew.com/&quot;&gt;local homebrew supply store&lt;/a&gt; and followed the directions.  There are plenty of ways to sanitize your 2L bottle, just make sure you follow the directions of whatever method you choose.  I’ve even heard of people using denture cleaning tablets to do the job, but  &lt;a href=&quot;https://www.google.com/search?q=sanitize+a+water+bottle&quot;&gt;Google should have the answers&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once your bottle is so fresh and so clean (clean) you can start grinding and juicing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/ground-ginger.jpg&quot; alt=&quot;Ground Ginger&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/juice-of-one-lemon.jpg&quot; alt=&quot;Juice Of One Lemon&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You’ll need about 1 1/2 (one and a half) Tbl of fresh ground ginger.  I did not measure the lemon juice, I just threw the ground ginger in the juice of one large lemon and made a slurry.  It smelled wonderful.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/sugar.jpg&quot; alt=&quot;Sugar&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/honey-with-sugar.jpg&quot; alt=&quot;Honey With Sugar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;None of the recipes called for honey, and I have a thing for local honey.  To remedy this obvious oversight, I decided to swap 1:1 honey for sugar, for 25% of the recommended sugar amount,  or in this case: 1/4 cup (I used &lt;a href=&quot;http://fowlerhoney.com/&quot;&gt;Fowler Honey&lt;/a&gt; which is close to my house).&lt;/p&gt;

&lt;p&gt;In an effort to minimize cleanup, I opted to just fill the 1C measuring cup 3/4 full of sugar and then fill to the top with honey.  While this sounds like a good idea at first, getting the honey/sugar mix to go down the funnel was not the most enjoyable experience, although it was apparently fun to watch.  I’d recommend measuring and adding them separately, unless you are a spectator, then encourage the soda-maker to combine these like I did.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/champagne-yeast.jpg&quot; alt=&quot;Champagne Yeast&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/yeast.jpg&quot; alt=&quot;Yeast&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We need bubbles, or this isn’t really soda, it’s just fancy Kool-Aid. While some recipes used bread yeast, I splurged for some good champagne yeast.  It was about a buck for enough to make 10 gallons.  You can buy it everywhere, even amazon, and your local home-brew store will definitely be able to hook you up.&lt;/p&gt;

&lt;p&gt;For our recipe we only use 1/8 teaspoon of yeast, which is not much more than a pinch.  Exact amounts are not very important, but too much will leave a yeasty taste in your soda.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/eating-on-the-job.jpg&quot; alt=&quot;Eating On The Job&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/adding-water.jpg&quot; alt=&quot;Adding Water&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/ready-to-ferment.jpg&quot; alt=&quot;Ready To Ferment&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Combine all the ingredients, fill bottle with water leaving about 1” of room at the top, cap it, and give it a good shake.  I purchased new caps at the home-brew store, making it much easier to reseal the bottle.  You’ll want to store the bottle somewhere room temperature, that is not in the sun, and wont be a horrible place for a soda bottle to blow up.  We picked a cabinet in the laundry room.&lt;/p&gt;

&lt;p&gt;Feel the bottle before you store it.  It should have plenty of “give”.  Now feel a store bought soda bottle.  It is firm.  Feel (and shake up) your ginger ale twice a day until it is as firm as the store bought stuff.  Then throw it in the fridge until it is cold.  If you use honey like I did, the shaking process may need to happen more often, and you’ll need to shake until all sugar/honey is fully dissolved - this took several mixings over the first day to accomplish.&lt;/p&gt;

&lt;p&gt;Online sources say the carbonation can be done in 48 hours. The week we made it was cool, and it took 3.5 days.&lt;/p&gt;

&lt;h3 id=&quot;results&quot;&gt;Results&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/ginger-beer/completed-bottle.jpg&quot; alt=&quot;Completed Bottle&quot; /&gt;
&lt;img src=&quot;/img/post/ginger-beer/final-glass.jpg&quot; alt=&quot;Final Glass&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have a winner.&lt;/p&gt;

&lt;p&gt;Straining the ginger ale makes for a less chunky experience, but either way it is good stuff.  You’ll want to keep it refrigerated and cold to prevent continued fermentation and carbonation, and it should be good for about a month with occasional burping.  This stuff is so tasty, there is no way it’ll last that long in our house.&lt;/p&gt;

&lt;p&gt;Apart from some measuring, sanitizing, and grating the ginger root, our 7 year old son was able to make most of this with me.  It is a fun and easy project, and our son loved checking the bottle every morning and evening.  Most of all he liked the final product.&lt;/p&gt;

&lt;h4 id=&quot;postscript&quot;&gt;Postscript&lt;/h4&gt;

&lt;p&gt;For anyone interested, here is what is on his shirt:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;You have brains in your head.
You have feet in your shoes.
You can steer yourself any
direction you choose.

-Dr Seuss
&lt;/code&gt;&lt;/pre&gt;
</description>
        <pubDate>Thu, 14 Mar 2013 00:00:00 -0500</pubDate>
        <link>http://jdstraughan.com/2013/03/14/homemade-ginger-ale-is-so-easy</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/03/14/homemade-ginger-ale-is-so-easy</guid>
        
        <category>soda making</category>
        
        <category>cooking</category>
        
        
      </item>
    
      <item>
        <title>HTML5 Snake source code walkthrough</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;Thank you &lt;a href=&quot;http://news.ycombinator.com/&quot;&gt;HackerNews&lt;/a&gt;&lt;/em&gt; for the &lt;em&gt;front-page&lt;/em&gt; love!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;Last month I made my first game: &lt;a href=&quot;https://github.com/JDStraughan/html5-lightcycles&quot;&gt;html5-lightcycles&lt;/a&gt;.  It is a Tron inspired lightcycle game, a humble recreation of the 1980s arcade classic. I wrote a blog post about the experience, &lt;a href=&quot;http://jdstraughan.com/2013/02/14/my-first-game-html5-lightcycles/&quot;&gt;you can check it out here&lt;/a&gt;.  The whole truth behind the lightcycle game includes the tidbit that when I first started playing around with the creating that game, snake was my original intention.&lt;/p&gt;

&lt;p&gt;For those that don’t know it, snake is one of the oldest video games, with origins in the 1970s.  Nokia put it on cell phones in 1998, and it became a staple of cell phone gaming.  The concept is simple: you control a snake that grows when it consumes food, and dies when it hits a wall or itself.  Some variants include obstacles, increased speed, and other mechanisms to increase difficulty.&lt;/p&gt;

&lt;p&gt;Moving a box across the canvas was easy, and turning off the screen reset gave me lightcycles for free.  Getting the snake to turn corners was not as easy as lightcycles, so I abandoned snake and moved on, eventually creating several proof of concept game-like creations.  I thought about snake again, and it hit me: the snake is an array, and shift()ing and push()ing coordinates would let it move properly, and when it got food, it could just skip the &lt;code&gt;shift()&lt;/code&gt;.  The rest just came together.&lt;/p&gt;

&lt;h2 id=&quot;the-game&quot;&gt;The Game&lt;/h2&gt;

&lt;p&gt;If you are visiting this page in an HTML5 capable browser, and are not on a mobile device, then this game should work for you.&lt;/p&gt;

&lt;iframe style=&quot;width: 100%; height: 480px&quot; src=&quot;http://jsfiddle.net/zT7V4/13/embedded/result/&quot; allowfullscreen=&quot;allowfullscreen&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;You can also view/play the game (in 640x480 mode) directly on &lt;a href=&quot;http://jsfiddle.net/zT7V4/9/embedded/result/&quot;&gt;jsfiddle&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;the-source-code&quot;&gt;The Source Code&lt;/h2&gt;

&lt;p&gt;For those that are interested, here is a quick overview of the code for this game.&lt;/p&gt;

&lt;p&gt;First, we need a basic page setup with a canvas tag.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;HTML5 snake - Canvas Snake Game&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--[if IE]&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;script src=&amp;quot;http://html5shiv.googlecode.com/svn/trunk/html5.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;![endif]--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;page.css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;html5-snake&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://en.wikipedia.org/wiki/HTML5&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;HTML5&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt; variation of the classic &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://en.wikipedia.org/wiki/Snake_(video_game)&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;snake game&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;canvas&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;the-game&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;320&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;240&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Control snake with arrow keys, WASD, or HJKL (vim keys).&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;New food may appear under snake, uncoil to reveal.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Collect the food to grow and increase speed.&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;&lt;span class=&quot;ni&quot;&gt;&amp;amp;copy;&lt;/span&gt; 2013 - &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://JDStraughan.com&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;JDStraughan.com&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt; - &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https://github.com/JDStraughan/html5-snake&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Source on GitHub&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;game.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nothing special here, just a standard page, canvas element, and some basic instructions and description of game play.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot; data-lang=&quot;css&quot;&gt;&lt;span class=&quot;nt&quot;&gt;article&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;aside&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;details&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;figcaption&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;footer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;hgroup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;menu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;nav&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;section&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;#CCC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;h1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;text-align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;center&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;text-align&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;center&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;canvas&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;margin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;auto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;#666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Again, very simple.  You could really skip all of this and just drop a canvas element on a page, but some basic styling and semantic markup goes a long way.&lt;/p&gt;

&lt;p&gt;HTML5 canvas games are javascript, like Soylent Green is people.&lt;/p&gt;

&lt;p&gt;In this game, I have one javascript file to rule them all: &lt;code&gt;game.js&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To make the code more bearable, I have organized the file into the following groups:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;game (object)&lt;/li&gt;
  &lt;li&gt;snake (object)&lt;/li&gt;
  &lt;li&gt;food (object)&lt;/li&gt;
  &lt;li&gt;some helpers/service methods&lt;/li&gt;
  &lt;li&gt;an event listener&lt;/li&gt;
  &lt;li&gt;the game loop&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Well, before all of that, we do have to grab the canvas context like so:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;the-game&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;2d&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now that we have that out of the way, lets take a walk thru something more fun.&lt;/p&gt;

&lt;h4 id=&quot;game-object&quot;&gt;Game Object&lt;/h4&gt;

&lt;p&gt;The &lt;code&gt;game&lt;/code&gt; object contains controls for score, game state, and some display.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;over&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;over&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;over&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;GAME OVER - PRESS SPACEBAR&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;drawBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fillStyle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;beginPath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;moveTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lineTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lineTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lineTo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;closePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;drawScore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fillStyle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;#999&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;font&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;px Impact, sans-serif&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;textAlign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fillText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;drawMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fillStyle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;#00F&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;strokeStyle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;#FFF&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;font&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;px Impact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;textAlign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fillText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;strokeText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;resetCanvas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;clearRect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Most of the property names should be self explanatory:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;game.score&lt;/code&gt; keeps the current score of the game, initially 0&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;game.fps&lt;/code&gt; stores the &lt;em&gt;frames per second&lt;/em&gt; (fps) the game is running at.  This increases with difficulty.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;game.over&lt;/code&gt; starts as true.  It just sounds right when checking for game state.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;game.message&lt;/code&gt; holds any messages to display to the user, for now there is only the “game over” message.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;game.start()&lt;/code&gt; method is pretty straightforward: it sets the game state via &lt;code&gt;game.over = false&lt;/code&gt; and clears the &lt;code&gt;game.message&lt;/code&gt; and &lt;code&gt;game.score&lt;/code&gt;, resets the fps, and then runs an &lt;code&gt;init()&lt;/code&gt; method on the &lt;code&gt;snake&lt;/code&gt; object.  We’ll see what that does in a second, but we can assume it initializes the snake “game piece”.  The same goes for &lt;code&gt;food.set()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;game.stop()&lt;/code&gt; method sets the game state to &lt;em&gt;over&lt;/em&gt; and displays a friendly message explaining how to start a new game.&lt;/p&gt;

&lt;p&gt;The next three methods draw things for the game: a box, a score, and a message.  The box method is used to draw both food and snake parts, as a snake is just a line of boxes.  The &lt;code&gt;game.drawBox()&lt;/code&gt; method takes an x and y coordinate, a size, and a color.  With these parameters, it can go to the x,y coordinates specified, and draw a box &lt;code&gt;size&lt;/code&gt; high and wide, and fill it with the &lt;code&gt;color&lt;/code&gt; desired.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;drawScore()&lt;/code&gt; is a bit different, as it displays the score almost full hight of the canvas, with a color very close to the background color.  This allows the score to be shown without having to sacrifice game board real-estate for the sole purpose of the score.&lt;/p&gt;

&lt;p&gt;Our &lt;code&gt;game.drawMessage()&lt;/code&gt; method also is nothing special, it checks if a &lt;code&gt;game.message&lt;/code&gt; exists, and puts in on the canvas if so.&lt;/p&gt;

&lt;p&gt;The last method in the &lt;code&gt;game&lt;/code&gt; object is &lt;code&gt;resetCanvas()&lt;/code&gt;.  This clears the canvas in between draws to allow the score and messages to be displayed properly, and wiped when needed.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;game&lt;/code&gt; object sets up a lot of the underpinning for our game, but the real challenge for me, and the coolest part of this game in my opinion, is the &lt;code&gt;snake&lt;/code&gt; object.&lt;/p&gt;

&lt;h4 id=&quot;snake-object&quot;&gt;Snake Object&lt;/h4&gt;

&lt;p&gt;While it’s no Mario, our snake is our hero.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;#0F0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;up&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;down&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;checkCollision&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;checkGrowth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawSection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;drawSection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;checkCollision&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isCollision&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;isCollision&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;checkGrowth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This object is significantly larger than the last one, and has a lot more coolness, also. The first thing the class does is initiate the &lt;code&gt;snake.size&lt;/code&gt; property, and we notice it is dynamic: &lt;code&gt;size: canvas.width / 40&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This game was designed to run on either a &lt;code&gt;320x240&lt;/code&gt; or &lt;code&gt;640x480&lt;/code&gt; canvas.  This means our &lt;code&gt;snake.size&lt;/code&gt; is directly proportional to our canvas, and at our predetermined canvas sizes, we’d end up with the following section sizes:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;320 / 40 = 8&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;640 / 40 = 16&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Note that here size refers to each section of the snake, so on a &lt;code&gt;320x240&lt;/code&gt; canvas, our snake will be made up of a bunch of 8x8 pixel squares.  Next we initialize the x and y coordinates for the snake, and set the default starting &lt;code&gt;direction&lt;/code&gt;.  Lastly, and most importantly, is the &lt;code&gt;snake.sections&lt;/code&gt; array.&lt;/p&gt;

&lt;p&gt;Unlike many game pieces, our snake does not just move, it crawls.  As its head moves forward, its body continues to follow the same path, and turning a corner can take several “moves”.  To accomplish this, our snake is make up of an array of coordinates, and we will &lt;code&gt;shift()&lt;/code&gt; and &lt;code&gt;push()&lt;/code&gt; coordinates off and on to the array to update it’s position.&lt;/p&gt;

&lt;p&gt;Creating a new snake has a few parts, so there is an &lt;code&gt;init()&lt;/code&gt; method to take care of getting it constructed. This method starts by ensuring the &lt;code&gt;sections&lt;/code&gt; array is cleared and the starting &lt;code&gt;direction&lt;/code&gt; is reset. It then places the snake in the middle of the game board, and again avoids hard-coded positions in favor of allowing for multiple canvas sizes.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We need to remember that when &lt;code&gt;game.drawBox()&lt;/code&gt; creates each section, it begins from the x,y coordinates, then creates a box based on the height and width with the x,y in the center.  This means that a box will have a center that is 1/2 the width and 1/2 the height.  To abide by these conditions, our snake is positioned accordingly.&lt;/p&gt;

&lt;p&gt;Lastly, our &lt;code&gt;init()&lt;/code&gt; method builds our starting snake:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This creates 5 array elements, each containing an x,y coordinate that is offset by the &lt;code&gt;snake.size&lt;/code&gt;.  Note that we are beginning the array with the tail, and ending it with the head. This will make &lt;code&gt;shift()&lt;/code&gt; remove the tail, and we can use &lt;code&gt;push()&lt;/code&gt; to advance the head position.  The &lt;code&gt;snake.x&lt;/code&gt; and &lt;code&gt;snake.y&lt;/code&gt; coordinates always refer to the head position.&lt;/p&gt;

&lt;p&gt;Next we have the &lt;code&gt;snake.move()&lt;/code&gt; method. This checks the &lt;code&gt;snake.direction&lt;/code&gt;, which is updated later in the script, and then manipulates the head of the snake accordingly.  Upward movement requires, the y coordinate to decrease, down increases, left decreases the x coordinate, and inversely, right increases it.  Notice the unit added or removed is &lt;code&gt;snake.size&lt;/code&gt;, since the snake sections sizes are larger than 1px we need to move the head by the size of the sections.&lt;/p&gt;

&lt;p&gt;After updating the head position, &lt;code&gt;snake.move()&lt;/code&gt; then invokes &lt;code&gt;snake.checkCollision()&lt;/code&gt;.  We’ll cover this method in a minute, just know it determines if the head as collided with the outside of the game area, or with an existing section of the snake.  Either of these results in the game being stopped.&lt;/p&gt;

&lt;p&gt;Next our &lt;code&gt;move()&lt;/code&gt; method continues on to the &lt;code&gt;snake.checkGrowth()&lt;/code&gt; method, which will allow the snake to grow if it is on the same position as a piece of food. Like &lt;code&gt;snake.checkCollision()&lt;/code&gt;, we’ll cover the internals of this function in more detail shortly.&lt;/p&gt;

&lt;p&gt;The last thing &lt;code&gt;move()&lt;/code&gt; does is &lt;code&gt;push()&lt;/code&gt; the new &lt;code&gt;snake.x&lt;/code&gt; and &lt;code&gt;snake.y&lt;/code&gt; coordinates onto the &lt;code&gt;snake.sections&lt;/code&gt; array.&lt;/p&gt;

&lt;p&gt;Our next method, &lt;code&gt;snake.draw()&lt;/code&gt;, iterates through the &lt;code&gt;snake.sections&lt;/code&gt; array and then splits the values into arrays with the x and y coordinates, and passes them along to the next method in the class: &lt;code&gt;snake.drawSection()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Here we circle back to the game.drawBox() function, and pass the x, y, size, and color of our snake.  In turn, each section is drawn, and our array can be represented as a series of boxes on our canvas.&lt;/p&gt;

&lt;p&gt;Moving on through the &lt;code&gt;snake&lt;/code&gt; object, we see the &lt;code&gt;checkCollision()&lt;/code&gt; and &lt;code&gt;isCollision()&lt;/code&gt; functions.  The first, &lt;code&gt;checkCollision()&lt;/code&gt;, is really just a helper that calls &lt;code&gt;isCollision()&lt;/code&gt; on our snake’s coordinates, and stops the game if there are any collisions found.&lt;/p&gt;

&lt;p&gt;Taking a look at &lt;code&gt;snake.isCollision()&lt;/code&gt;, we find that determining if our snake if out of bounds or being cannibalistic is not very difficult:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;isCollision&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The first four tests determine if the head of our snake has moved to a position that is outside the boundaries of our canvas. Again we are reminded to check for half of the size of the snake when looking for boundaries.  If all those checks pass, we then see if the snake has attempted to eat itself by seeing if the coordinates exist in the &lt;code&gt;snake.sections&lt;/code&gt; array.&lt;/p&gt;

&lt;p&gt;The last method in our &lt;code&gt;snake&lt;/code&gt; class is there to see if our snake needs to grow.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;checkGrowth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sections&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I could have probably named this method better, and future versions may see this refactored out into some more granular functions for readability and maintainability.  For now, we’ll dissect it as it is.  The method starts off by determining if the head position of the snake is the same as the position of the food, the proverbial mushroom for our hero snake.  If the head is on a food piece the function increases the &lt;code&gt;game.score&lt;/code&gt;, calls &lt;code&gt;food.set&lt;/code&gt;, and if the score is divisible by 5 it increases the the game speed by 1 FPS.  If the snake is not on a food piece, then it &lt;code&gt;shifts()&lt;/code&gt; off the tail section.  Notice if the snake eats food, the &lt;code&gt;shift()&lt;/code&gt; never happens. This is how our snake grows.&lt;/p&gt;

&lt;h4 id=&quot;food-object&quot;&gt;Food object&lt;/h4&gt;

&lt;p&gt;Our food object is short and sweet.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;#0FF&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawBox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Like the snake object, &lt;code&gt;food&lt;/code&gt; must have a &lt;code&gt;size&lt;/code&gt;, &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, and &lt;code&gt;color&lt;/code&gt;. The real magic in this object is in the &lt;code&gt;set&lt;/code&gt; method.&lt;/p&gt;

&lt;p&gt;When &lt;code&gt;food.set&lt;/code&gt; is called, the first thing that happens is the size of the food is set to match the size of the snake.  Next, we set this x and y coordinates for randomized food placement.  Because our snake really moves around in a grid that is determined by the width of each section, not every pixel on the canvas is accessible by the center of the snake’s head.  To place food in a position where can be consumed, some care must be given.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We can determine that &lt;code&gt;Math.ceil(Math.random() * 10&lt;/code&gt; will return an integer between 1 and 10, and we can multiply that by &lt;code&gt;snake.size&lt;/code&gt; and the ratio it has in relation to the overall canvas.  To offset for the center of the snake head, we’ll need to subtract the width, &lt;code&gt;snake.size / 2&lt;/code&gt;.  This looks complex, but it really just finds an x,y placement that is inside the canvas and accessible to our snake.&lt;/p&gt;

&lt;p&gt;The last method in our &lt;code&gt;food&lt;/code&gt; class is &lt;code&gt;draw()&lt;/code&gt;.  Predictably, this simply calls the &lt;code&gt;game.drawBox()&lt;/code&gt; method, and passes along all the food parameters.&lt;/p&gt;

&lt;h4 id=&quot;helpers&quot;&gt;Helpers&lt;/h4&gt;

&lt;p&gt;To make this game work, we need to be able to utilize a few helpers.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;inverseDirection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&amp;#39;up&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;down&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&amp;#39;down&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;up&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;keys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;72&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;68&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;76&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;start_game&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We cannot allow our snake to move the opposite direction it is currently moving, and having a quick place to lookup the inverse of a direction is helpful, so we have a &lt;code&gt;inverseDirection&lt;/code&gt; object where this can be accomplished easily.&lt;/p&gt;

&lt;p&gt;We want our users to be able to use multiple sets of keys to control our snake, so we have a &lt;code&gt;keys&lt;/code&gt; object literal that defines our four directions with arrays of &lt;a href=&quot;http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes&quot;&gt;char codes&lt;/a&gt; for the respective keys.  We’ll be accepting WASD, arrow keys, and the vim movement keys HJKL.&lt;/p&gt;

&lt;p&gt;The last of our helpers adds a &lt;code&gt;getKey()&lt;/code&gt; method to the Object prototype so we can see if a key code is present in our &lt;code&gt;keys&lt;/code&gt; object, and if so return the key of the matched value. So really all it does it return a direction based on a key’s char code.  This makes our life a lot easier when we need to see if a key represents a direction.&lt;/p&gt;

&lt;p&gt;We’re on our way to a complete game.  All that is left is a way to listen for new input, and the infamous game loop.&lt;/p&gt;

&lt;h4 id=&quot;event-listener&quot;&gt;Event Listener&lt;/h4&gt;

&lt;p&gt;Javascript makes it very easy to listen for new inputs from the keyboard.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;keydown&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;lastKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keyCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;up&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;down&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lastKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lastKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inverseDirection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lastKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;start_game&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lastKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;over&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now when a key is pressed, our event listener will fire, and these few lines of code with execute.  Here we utilize our &lt;code&gt;getKey()&lt;/code&gt; method to see if the key pressed was a movement key, and if so we also assert that it is not the &lt;code&gt;inverseDirection&lt;/code&gt; of our current &lt;code&gt;snake.direction&lt;/code&gt;.  If these conditions are met, the &lt;code&gt;snake.direction&lt;/code&gt; is updated and our snake will be off on a new bearing.  If the key was not a direction key, the listener checks to see if it was a spacebar or enter key, and if it is the &lt;code&gt;game.start()&lt;/code&gt; method is called.  If the key is none of these, the key-press is ignored.&lt;/p&gt;

&lt;p&gt;That is pretty simple, and our helpers made the listener much easier to read and follow along with.&lt;/p&gt;

&lt;h4 id=&quot;game-loop&quot;&gt;Game loop&lt;/h4&gt;

&lt;p&gt;Here were are, the final stage.  We’ve done all the heavy lifting of creating our game environment, our player, objectives, scoring, difficulty increases and even the drawing of our assets.  Now we need to pull it all together and make it run.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;webkitRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mozRequestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;over&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resetCanvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawScore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;food&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;For our game loop, I am using the &lt;code&gt;requestAnimationFrame&lt;/code&gt; method, which requires setting the appropriate, browser specific function.  For a detailed look at &lt;code&gt;requestAnimationFrame&lt;/code&gt;, I recommend consulting &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame&quot;&gt;The Book of Mozilla&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once the &lt;code&gt;requestAnimationFrame&lt;/code&gt; is set, it can be called to update our canvas and will keep our refresh rate at or below 60 FPS.  The &lt;code&gt;requestAnimationFrame&lt;/code&gt; accepts a callback that is invoked no more than 60 times per second, and in our case we’ll use it in a recursive &lt;code&gt;loop()&lt;/code&gt; function.&lt;/p&gt;

&lt;p&gt;Looking inside &lt;code&gt;loop()&lt;/code&gt;, we see the first thing that happens a check for the games state.  If the game is active  (not over) then a series of instructions is executed. Let’s review what each of these do:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;game.resetCanvas()&lt;/code&gt; - Clears the canvas of all drawings&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;game.drawScore()&lt;/code&gt; - Draws the &lt;code&gt;game.score&lt;/code&gt; into the background of our game board&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;snake.move()&lt;/code&gt; - Calculates the new head position of our snake&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;food.draw()&lt;/code&gt; - Places a piece of food on the game board&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;snake.draw()&lt;/code&gt; - Draws our snake by iterating through the &lt;code&gt;snake.sections&lt;/code&gt; array&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;game.drawMessage()&lt;/code&gt; - Displays game messages on screen, used for GAME OVER message&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By executing these functions multiple times a second, our snake is able to move, and our game becomes alive.  To do this, we’ll create an infinite loop.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;game&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;No human can control our snake advancing 60 times per second, so to slow down animation we can throttle the &lt;code&gt;requestAnimationFrame&lt;/code&gt; to only fire &lt;em&gt;n&lt;/em&gt; times per second by using javascript’s native &lt;code&gt;setTimeout()&lt;/code&gt; method.  Remember we initialize &lt;code&gt;game.fps&lt;/code&gt; to 8, so &lt;code&gt;setTimeout()&lt;/code&gt; will allow &lt;code&gt;requestAnimationFrame&lt;/code&gt; to execute 8 times per second, and it will increase along with &lt;code&gt;game.fps&lt;/code&gt; to make the snake move faster over time. There are other methods available for controlling game speed, but I like the way this give the snake that vintage gaming feel, with a bit of a jerking motion when as it slithers to its next meal.&lt;/p&gt;

&lt;p&gt;The script in completed with one final line of code that sets our &lt;code&gt;loop()&lt;/code&gt; function in motion:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We now have a classic game recreated in javascript, in just a couple of hundred lines of code.  The source is &lt;a href=&quot;https://github.com/JDStraughan/html5-snake&quot;&gt;available on GitHub for your forking pleasure&lt;/a&gt;.  For my second complete HTML5 game, I’m pretty happy and learned a lot about the canvas element, and game development in general.  I look forward to your questions and constructive criticism in the comments section below.&lt;/p&gt;
</description>
        <pubDate>Tue, 05 Mar 2013 00:00:00 -0600</pubDate>
        <link>http://jdstraughan.com/2013/03/05/html5-snake-with-source-code-walkthrough</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/03/05/html5-snake-with-source-code-walkthrough</guid>
        
        <category>html5</category>
        
        <category>javascript</category>
        
        <category>game development</category>
        
        
      </item>
    
      <item>
        <title>My first game - HTML5 lightcycles</title>
        <description>&lt;p&gt;For the past few months I have been playing with the &lt;a href=&quot;http://en.wikipedia.org/wiki/Canvas_element&quot;&gt;HTML5 canvas element&lt;/a&gt; off and on.  In recent years it has been the subject of much excitement in the web development community, and as matured rapidly in modern browsers.  Now there are a wide variety of games and activities that utilize this relatively new element.&lt;/p&gt;

&lt;p&gt;For whatever reasons, I just assumed manipulating the canvas would be a pain in the ass, so I avoided it.  I thought, “I am not a game developer, so I have no need for it.”  I understood that not all canvas use was in the realm of game development, however, the other use cases weren’t inspiring me to learn.&lt;/p&gt;

&lt;p&gt;So I ignored the canvas.&lt;/p&gt;

&lt;p&gt;Until a few months ago.  I was reading a thread on reddit and commenting to a new web developer about how learning to program is a process of writing code that does not work properly, finding the issues, fixing them, and then moving on.  In this same thread, someone had commented that when they get bored learning a particular programming lesson, they just fire up &lt;a href=&quot;http://jsfiddle.net/&quot;&gt;jsfiddle&lt;/a&gt; and play with the canvas - because, they said - “it is just so fun and simple”.&lt;/p&gt;

&lt;p&gt;Fun and simple? Canvas?&lt;/p&gt;

&lt;p&gt;“Canvas is simple and fun”, they said. “Reddit is full of trolls”, I said. I don’t like to feed the trolls.  If it was simple, everyone would be doing it.  If it were simple, then even I could write a game in javascript. So like any good redditor, I fired up my browser and was going to prove to the world that this cannot be, in any way, simple.&lt;/p&gt;

&lt;p&gt;A few minutes later I had a square drawn on my screen.  A few hours later I had multiple shapes in different colors.  And they were moving.  By the end of that first day, I had accomplished no real work, but I had shapes moving on my screen, under my control.&lt;/p&gt;

&lt;p&gt;My mind exploded with ideas.  Every mirror I passed had a cheerful Gabe Newell staring back at me.  It had been over twenty years since I thought about writing games when I grew up.  I have written code all my life, but somewhere along the way I lost the dream of my childhood.  I had never written a game.&lt;/p&gt;

&lt;p&gt;Unfortunately, I have a job.  Where I write code.  I can’t really complain, I like writing code, but everyday my mind was aching to get back to the canvas.  Although I have not been able to devote large swaths of time to this endeavor, a few hours here and there is all that is needed to learn the basics required to get a game going in HTML5.  I’d draw shapes, make them spin, move, wrap, warp, and collide.&lt;/p&gt;

&lt;p&gt;I had finally done it - I was writing a game.  Several, in fact. I had started a snake game, an asteroids game, and a math puzzle game.  I was like Peter Pan.  I tinkered with each, wrote and replaced a lot of bad code, contemplated how to determine if my shape collided with another, read stack overflow, blogs, and docs.&lt;/p&gt;

&lt;p&gt;A few days ago I decided to lower the bar, and just sit down and complete a game.  Something that could be played, had a beginning and an end, and was fun.  Thinking about what I wanted to build, I started with a small blue box and started moving it around the canvas.  Then I commented out the code that redraws the board several times a second and kept “playing”.  As you can guess, the box did not just move anymore, it just “expanded” in one direction.  Like the lightcycles from Tron.&lt;/p&gt;

&lt;p&gt;I was 7 (the same age my son is now) when Tron came to the movie theater, and it changed my life.  Programs, users, computers, graphics, gaming: Tron had it all.  It was also one of the first VHS movies we had, and I am sure I just about wore the tape out.  Once the arcade game was released, like many kids in the 80s, I dropped every quarter I could find into it.  Of all the games it offered, I loved the lightcycles.  I fought for the Users.&lt;/p&gt;

&lt;div class=&quot;video&quot;&gt;
&lt;iframe width=&quot;640&quot; height=&quot;480&quot; src=&quot;http://www.youtube.com/embed/ONg0rUogiEg?rel=0&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;h5&gt;Original Tron arcade game - lightcycle level&lt;/h5&gt;
&lt;/div&gt;

&lt;p&gt;I had my inspiration.  I’d build a lightcycle game.&lt;/p&gt;

&lt;p&gt;For the uninitiated, like myself, the logic behind gaming is a mystery.  I have contemplated it often, but in all honesty have not read much on the subject.&lt;/p&gt;

&lt;p&gt;Based on my previous experiments, reading lots of blog posts (I wish I could list them all here) and a fair amount of generous stackoverflow answers, I could make my cycle appear, move, and I had figured out how to detect if I had left the game grid.&lt;/p&gt;

&lt;p&gt;The canvas, after all, is just a bitmap with a simple API.  Like an etch-a-sketch.  You can move to a location, draw, fill, relocate, etc.  Because this etch-a-sketch is in a computer, you can refresh it so many times a second no one will ever be the wiser.  That is how animation works.&lt;/p&gt;

&lt;p&gt;The tutorials, blogs, and answers got me that far.  Beyond this was still covered in a cloud of mystery.  In my snake game I had not crossed the issue of the snake colliding with itself, and randomizing the location of the bait after each consumption was pretty easy. While this attempt at a game has not found completion, it was the early sandbox that I used to work with.  This lightcycle game was going to require an enemy, not just a piece of bait.  This enemy would need to have some intelligence, the game would need to know when there was a collision, and it would need to determine a winner.  These all seemed like daunting tasks.&lt;/p&gt;

&lt;p&gt;I thought about studying up on some game development, finding a good framework, and putting together a game.  Someday I may do this, but I decided to stick with native js, learn the ropes, see what is happening under the hood.  I’d just try to solve some of these problems and then go see how others do it.  For the lightcycle’s walls, for example, I just made a &lt;code&gt;history&lt;/code&gt; array withe coordinates of each movement.  Each time a cycle moves, it checks that the new coordinates are not outside the map, or in the history of either cycle.  Why did I not just lump them all into one array?  Who knows, I was too busy trying to figure out how to make it work.  Is there a better way?  I sure hope so, but this was working so I moved on.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Note: A redditor pointed out it would be better to have an game board 2D array that stores the x,y coords of used tiles and instead of checking &lt;code&gt;indexOf&lt;/code&gt; for each cycle’s history, I can just look for existence of the x,y in the array. I’ll add this in the next iteration of the game. Thanks &lt;em&gt;dmcinnes&lt;/em&gt;!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Soon I had collisions, movement, light.  I felt close to completion.  Then I realized I had to create some way to control the enemy cycle, and it was not going to write itself.  For my first attempt, I simply had the enemy cycle start each turn looking right, and if it could go right it did.  Then it looked up, then left, then down.  It was not the smartest cycle in the world, but it gave me something to play against while testing my other code.&lt;/p&gt;

&lt;p&gt;In my second attempt at “AI” (I use that term very loosely), I decided to create an advisor method.  This function would scan the 4 directions, determine the best one, and advise the cycle of the direction with the most runway.  If the current direction was blocked in the next tile, it would turn using the best route.  To keep the player on their toes, it also has a ~10% chance of turning to the advisor’s best option on each turn.&lt;/p&gt;

&lt;p&gt;Not the most elegant approach, I admit, but it works.  As of the time of this writing, it is what is currently controlling the Program bike. This method does beat me more often than I’d care to admit.  Of all the areas I’d like to spend more time perfecting, this is the most intriguing to me.&lt;/p&gt;

&lt;p&gt;Overall, I am quite happy that for under 250 lines of javascript I was able to produce a playable game that is both fun and challenging.  If you are looking for a simple and fun way to expand your programming chops, I highly recommend trying out the canvas element.&lt;/p&gt;

&lt;p&gt;You can play my HTML5 lightcycle game &lt;a href=&quot;http://jsfiddle.net/PxpVr/17/embedded/result/&quot;&gt;in 640x480 mode here&lt;/a&gt;, or &lt;a href=&quot;http://jsfiddle.net/PxpVr/16/embedded/result/&quot;&gt;in 320x240 mode here&lt;/a&gt;. As always, source code is &lt;a href=&quot;https://github.com/JDStraughan/html5-lightcycles&quot;&gt;available on GitHub&lt;/a&gt;.&lt;/p&gt;
</description>
        <pubDate>Thu, 14 Feb 2013 00:00:00 -0600</pubDate>
        <link>http://jdstraughan.com/2013/02/14/my-first-game-html5-lightcycles</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/02/14/my-first-game-html5-lightcycles</guid>
        
        <category>html5</category>
        
        <category>javascript</category>
        
        <category>game development</category>
        
        
      </item>
    
      <item>
        <title>NoNews Part II - The Source</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/no-news-is-good-news/fnikidjfogfllkinoahanihoddalbhil&quot;&gt;NoNews is a Google Chrome extension&lt;/a&gt; that I built to assist me (and you) in avoiding passively reading the news while casually surfing the web.  I wrote a &lt;a href=&quot;http://jdstraughan.com/2013/01/29/nonews-is-good-news/&quot;&gt;blog post about why I made it&lt;/a&gt;, and explored the &lt;a href=&quot;http://www.aaronsw.com/weblog/hatethenews&quot;&gt;inspiration&lt;/a&gt; behind the endeavor.  In this post I’d like to walk-through the &lt;a href=&quot;https://github.com/JDStraughan/nonews&quot;&gt;source code&lt;/a&gt;, explain how the extension is constructed, and talk about things that can be done to improve the product.&lt;/p&gt;

&lt;p&gt;This was my first attempt at creating a browser plugin, and I relied heavily on the &lt;a href=&quot;http://developer.chrome.com/extensions/&quot;&gt;developer documentation&lt;/a&gt; provided by Google.  At first glance it seemed lacking, and while the organization and example code was not always fulfilling, the docs do provide all the information needed to begin the journey into extension creation. Being my first extension, I am not sure I followed all the best practices or chose the best route for accomplishing my task, however, with a small amount of code I was able to create a fully functioning plugin with a few features with very little time invested. Experienced extension developers: I look forward to your constructive criticism in the comments!&lt;/p&gt;

&lt;h2 id=&quot;the-code&quot;&gt;The Code&lt;/h2&gt;

&lt;p&gt;The biggest challenge I faced was understanding the difference between &lt;a href=&quot;http://developer.chrome.com/extensions/manifestVersion.html&quot;&gt;manifest versions 1 and 2&lt;/a&gt;.  More importantly, I would find example code written for manifest v1, and attempt to make it work in v2.  This was the source of much frustration.  NoNews is written using manifest v2, so hopefully you don’t have the same issues I did.&lt;/p&gt;

&lt;p&gt;Note: if there are future updates and you need to match source code, this walkthrough is using &lt;a href=&quot;https://github.com/JDStraughan/nonews/tags&quot;&gt;tagged version 0.5 of NoNews&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Speaking of manifest files, lets take a look at &lt;code&gt;manifest.json&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;No News (is Good News!)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;manifest_version&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;version&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0.5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;homepage_url&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://www.nonews.info&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;description&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Warns you of news pages that may ruin your day ;)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;icons&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;16&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon16.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;s2&quot;&gt;&amp;quot;48&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon48.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;128&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon128.png&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;browser_action&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_icon&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;19&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon19.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;38&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon38.png&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_title&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;No News (is Good News!)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_popup&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;html/popup.html&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;permissions&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;webRequest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;webRequestBlocking&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://*/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://*/&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;background&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;scripts&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;js/nonews.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;JSON should be familiar to all of us, and it is pretty easy to see what is going on for most of this file.  The manifest defines and configures things like the name, url, asset locations, permission settings, manifest_version, etc. We will need to refer back to this file though out the build to explain each section, but this is what the final product looks like. The developer docs have a great &lt;a href=&quot;http://developer.chrome.com/extensions/manifest.html&quot;&gt;summary of manifest options&lt;/a&gt; that explains the different settings available.&lt;/p&gt;

&lt;p&gt;It is also worth mentioning that there is not a strict directory structure for extensions, with many simply having all the files in the root directory.  For this extension, I am using a file structure that looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.
├── README.md
├── assets
│   └── blacklist.json
├── changelog.txt
├── css
│   └── popup.css
├── html
│   └── popup.html
├── img
│   ├── icon128.png
│   ├── icon48.png
│   └── icon16.png
├── js
│   ├── nonews.js
│   └── popup.js
└── manifest.json
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Most of this is self explanatory, but let’s do a quick overview of the files.  The &lt;code&gt;README.md&lt;/code&gt; file is there for GitHub, since this is an open-source project. Next up is the &lt;code&gt;assets&lt;/code&gt; directory, which contains one file: &lt;code&gt;blacklist.json&lt;/code&gt;.  This file is responsible for seeding the extension with a list of URLs that will be blocked by the browser.  The &lt;code&gt;css/popup.css&lt;/code&gt;, &lt;code&gt;html/popup.html&lt;/code&gt; and &lt;code&gt;js/popup.js&lt;/code&gt; files generate the the popup display that occurs when a user places their mouse over the icon next to the address bar.  The icons listed in the &lt;code&gt;/img&lt;/code&gt; directory fulfill the sizes required as shown &lt;a href=&quot;http://developer.chrome.com/extensions/manifest.html#icons&quot;&gt;here&lt;/a&gt;.  The &lt;code&gt;js/nonews.js&lt;/code&gt; file holds all the logic for our extension, and we are already familiar with the &lt;code&gt;manifest.json&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;Now that we have the directory structure and manifest file out of the way, let’s dive into the most important file in the extension: the event page.  The docs tell us that through v1, extensions had the option to run a background script that continually monitored and reacted on browser events.  In v2, we have the ability to set persistence on event pages - a persistent event page is a background page, and setting persistent to false let’s us have an event page that is only loaded as needed.  For more information, read the &lt;a href=&quot;http://developer.chrome.com/extensions/event_pages.html&quot;&gt;documentation on event pages&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Looking back at the &lt;code&gt;manifest.json&lt;/code&gt; file, we see that we have a non-persistant background page located at &lt;code&gt;js/nonews.js&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;background&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;scripts&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;js/nonews.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Since the default in v2 is &lt;code&gt;&quot;persistence&quot;: false&lt;/code&gt;, it is not being explicitly set here.  The docs tell us what this means in terms of when our extension will be loaded:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;The extension is first installed or is updated to a new version (in order to register for events).&lt;/li&gt;
    &lt;li&gt;The event page was listening for an event, and the event is dispatched.&lt;/li&gt;
    &lt;li&gt;A content script or other extension sends a message.&lt;/li&gt;
    &lt;li&gt;Another view in the extension (for example, a popup) calls chrome.runtime.getBackgroundPage().&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;So this script is a perfect place to setup our extension, and add any event listeners we may need.  Let’s take a loot at this event page.&lt;/p&gt;

&lt;h5 id=&quot;jsnonewsjs&quot;&gt;js/nonews.js&lt;/h5&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;undefined&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// Get the file for the blacklist to load from json&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt;   &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fileURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;../assets/blacklist.json&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;   &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;XMLHttpRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fileURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// The file should be in xmlreq.responseText&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;responseText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Add the event listener with filters&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;webRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onBeforeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt;   &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// Check for manual bypass via query string&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;nonews_bypass=true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;18&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;19&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// Check for snooze option&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;20&lt;/span&gt;     &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;21&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;22&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;23&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;24&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// Redirect to blocked site page, passing url for bypass option&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;25&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;26&lt;/span&gt;       &lt;span class=&quot;nx&quot;&gt;redirectUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://www.nonews.info/blocked-site.html?site=&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;27&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;28&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;29&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// filters&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;30&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;31&lt;/span&gt;     &lt;span class=&quot;nx&quot;&gt;urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;main_frame&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;33&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;34&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// extratabSpec&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;35&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;blocking&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;36&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;That, ladies and gentlemen, is the bulk of the code to make this extension work.  A handful of lines of native javascript using the Chrome API is all that is required to make this thing go.  Breaking it down into sections makes it easier to consume:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;undefined&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// Get the file for the blacklist to load from json&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt;   &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fileURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;../assets/blacklist.json&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;   &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;XMLHttpRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fileURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// The file should be in xmlreq.responseText&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;xmlreq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;responseText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Starting with line 1, I am checking to see if we have already stored the blacklist into &lt;a href=&quot;http://en.wikipedia.org/wiki/Web_storage#Local_and_session_storage&quot;&gt;localStorage&lt;/a&gt;.  This is not incredibly important for this version of the extension, as we could just load the blacklist into a variable that will be used in the event listener, however, adding to localStorage allows us to easily manipulate this list in the future, possibly through and &lt;a href=&quot;&quot;&gt;options page&lt;/a&gt; interface.&lt;/p&gt;

&lt;p&gt;If the black list is not already loaded, lines 3-6 use a &lt;code&gt;XMLHttpRequest&lt;/code&gt; to load the &lt;code&gt;assets/blacklist.json&lt;/code&gt; file.  Before we move on, let’s take a quick look at the blacklist file:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;s2&quot;&gt;&amp;quot;urls&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
		&lt;span class=&quot;s2&quot;&gt;&amp;quot;*://*.10news.com/*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;s2&quot;&gt;&amp;quot;*://*.10tv.com/*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

		&lt;span class=&quot;s2&quot;&gt;&amp;quot;*://*.zoiksonline.com/*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;s2&quot;&gt;&amp;quot;*://*.zwire.com/*&amp;quot;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The actual file is over 6300 lines long, containing most of the websites from &lt;a href=&quot;http://www.labnol.org/tech/google-news-sources/19321/&quot;&gt;this list of Google News sources&lt;/a&gt;. I am sure you have observed that these are not URLs, rather they are &lt;a href=&quot;http://developer.chrome.com/extensions/match_patterns.html&quot;&gt;match patterns&lt;/a&gt; that define our blacklist of sites.&lt;/p&gt;

&lt;p&gt;In line 9 of the &lt;code&gt;nonews.js&lt;/code&gt; file we see that the blacklist is loaded as a string into &lt;code&gt;localStorage&lt;/code&gt;, and is now available for our extension to use.  Moving on we see the 2nd half of the event page:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// Add the event listener with filters&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;webRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onBeforeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Check for manual bypass via query string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;nonews_bypass=true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Check for snooze option&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Redirect to blocked site page, passing url for bypass option&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;redirectUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://www.nonews.info/blocked-site.html?site=&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// filters&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;main_frame&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// extratabSpec&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;blocking&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here we are using the &lt;a href=&quot;https://developer.chrome.com/extensions/webRequest.html&quot;&gt;chrome.webRequest&lt;/a&gt; module to create our filters. According to the docs:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;You must declare the “webRequest” permission in the extension manifest to use the web request API, along with host permissions for any hosts whose network requests you want to access.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;To accomplish this, we have this section in the &lt;code&gt;manifest.json&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;permissions&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;webRequest&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;webRequestBlocking&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://*/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://*/&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This gives permission to &lt;code&gt;chrome.webRequest&lt;/code&gt;, &lt;code&gt;chrome.webRequestBlocking&lt;/code&gt;, and all URLs using &lt;code&gt;http|https&lt;/code&gt;.  We’ll be using &lt;a href=&quot;https://developer.chrome.com/extensions/webRequest.html#type-BlockingResponse&quot;&gt;webRequestBlocking&lt;/a&gt; to stop the request from executing, and instead we’ll redirect the user elsewhere.  Before we cover that, we back up and look at the event listener.&lt;/p&gt;

&lt;p&gt;In the webRequest module, we are adding an event listener to the &lt;code&gt;onBeforeRequest&lt;/code&gt; which the docs tell us:
&amp;gt; Fires when a request is about to occur. This event is sent before any TCP connection is made and can be used to cancel or redirect requests.&lt;/p&gt;

&lt;p&gt;That is exactly what we need to stop the browser from displaying a page that originates at a site in our blacklist. The &lt;code&gt;addListener&lt;/code&gt; method is available via the &lt;a href=&quot;https://developer.chrome.com/extensions/events.html&quot;&gt;chrome.events&lt;/a&gt; module, and the docs tell us:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The argument to addListener() is always a function that you define to handle the event, but the parameters to the function depend on which event you’re handling.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In the case of &lt;code&gt;chrome.webRequest.onBeforeRequest&lt;/code&gt;, the addListener method takes these arguments: &lt;code&gt;callback&lt;/code&gt;, &lt;code&gt;filter&lt;/code&gt;, and &lt;code&gt;opt_extraInfoSpec&lt;/code&gt;. The callback is the anonymous function we are using as the first argument, we are passing an object listing our filtered URLs in the second argument, and an array containing one value, “blocking”, in the third.&lt;/p&gt;

&lt;p&gt;Working backwards, let’s look at this “blocking” array first. The docs tell us:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If the optional opt_extraInfoSpec array contains the string ‘blocking’ (only allowed for specific events), the callback function is handled synchronously. That means that the request is blocked until the callback function returns.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Perfect! So if there is a match in the filters, the request will be blocked until the callback is completed.  Let’s look at the filters next.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// filters&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;urls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_blacklist_urls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;main_frame&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;a href=&quot;https://developer.chrome.com/extensions/webRequest.html#type-RequestFilter&quot;&gt;request filter&lt;/a&gt; requires a &lt;code&gt;urls&lt;/code&gt; property containing a list of URLs or URL patterns, and has 3 optional properties.  We’ll use the optional &lt;code&gt;types&lt;/code&gt; property to define &lt;code&gt;main_frame&lt;/code&gt; as the request type we are limiting our filter to.  Notice to assemble the list of urls, we are just parsing the locally stored string into a JSON format.&lt;/p&gt;

&lt;p&gt;Finally, we are at the heart of the extension, the callback that will be fired when a request is blocked.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Check for manual bypass via query string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;nonews_bypass=true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Check for snooze option&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Redirect to blocked site page, passing url for bypass option&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;redirectUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://www.nonews.info/blocked-site.html?site=&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// filters&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We are passing the &lt;code&gt;tab&lt;/code&gt; object to the function so we can made some decisions based on the contents of that object.  Although we have not looked at the features for bypassing and snoozing the extension, the code is not incredibly difficult.&lt;/p&gt;

&lt;p&gt;First, we are checking to see if the query string contains &lt;code&gt;nonews_bypass=true&lt;/code&gt;, and if so, we are simply returning and allowing the browser to go on its merry way.&lt;/p&gt;

&lt;p&gt;Next, we are setting &lt;code&gt;now&lt;/code&gt; to reflect the current unix timestamp, and asserting that if there is a &lt;code&gt;localStorage&lt;/code&gt; variable named &lt;code&gt;nonews_snooze_end&lt;/code&gt;, and it is larger than &lt;code&gt;now&lt;/code&gt;, then we get out of the way and let the user go.&lt;/p&gt;

&lt;p&gt;If none of these conditions are met, we simply redirect the user to a web page that serves as the blocked page, and we pass a query string setting the original request URL.&lt;/p&gt;

&lt;p&gt;The public facing site for NoNews is available in the &lt;a href=&quot;https://github.com/JDStraughan/nonews/tree/website&quot;&gt;website branch of the repository&lt;/a&gt;. It is a simple, static HTML site that can be easily hosted on places like GitHub Pages or S3, so you will not need any special web server on you local machine to view.  Just open pages in your browser and you’ll be good to go.&lt;/p&gt;

&lt;p&gt;Currently, the blocked page looks like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/nonews-blocked-site-screen-800.jpg&quot; alt=&quot;Nonews Blocked Site Screen&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Screenshot of blocked URL with red bypass button and snooze bar popup open.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In this screen shot, you can see the red button on the blocked site page that touts the ability to allow you to continue on your way.  This is accomplished by some javascript in the website branch that creates a link using the original request URL with &lt;code&gt;nonews_bypass=true&lt;/code&gt;added as part of the query string.  This creates a link that will successfully meet the requirement in the callback function to temporarily disable blocking for the request.&lt;/p&gt;

&lt;p&gt;In the upper righthand portion of the image, we can see the NoNews snooze bar.  This area is created when someone clicks on the NoNews icon that is added to the right of the address bar.  Going back to the manifest we see:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;browser_action&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_icon&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;19&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon19.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;38&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;img/icon38.png&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_title&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;No News (is Good News!)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;default_popup&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;html/popup.html&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;a href=&quot;http://developer.chrome.com/extensions/browserAction.html&quot;&gt;browser action&lt;/a&gt; module is described as:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Use browser actions to put icons in the main Google Chrome toolbar, to the right of the address bar. In addition to its icon, a browser action can also have a tooltip, a badge, and a popup.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The icons are defined by their names as a convention for Chrome to know their size.  The &lt;code&gt;default_title&lt;/code&gt; will be the tool tip text shown on hover, and the &lt;code&gt;default_popup&lt;/code&gt; contains the location of the page to be loaded when the icon is clicked.&lt;/p&gt;

&lt;h5&gt;html/popup.html&lt;/h5&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;../css/popup.css&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;popup&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;h3&amp;gt;&lt;/span&gt;No News (is Good News)&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
		A friendly reminder that reading the news is not always a good thing.
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
		Inspiration: &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.aaronsw.com/weblog/hatethenews&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;_blank&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;This essay&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt; by &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://en.wikipedia.org/wiki/Aaron_Swartz&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;_blank&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Aaron Swartz&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;.
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
		No News is open source! Visit our &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https://github.com/jdstraughan/nonews&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;_blank&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;GitHub Page&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;.
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;snooze_container&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;p&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;../js/popup.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This is a pretty straightforward HTML file, with the only notable areas being the &lt;code&gt;snooze_container&lt;/code&gt;, and the javascript file that is loaded at the end of the file.&lt;/p&gt;

&lt;h5 id=&quot;jspopupjs&quot;&gt;js/popup.js&lt;/h5&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;setSnoozeContents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;el&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;nonews_snooze&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;el&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;el&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;click&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Set the snooze period to stop filter from blocking sites&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Do nothing if stored is still valid&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Set new snooze time (in unix timestamp (in milliseconds))&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Set for 15 minutes in the future (90000ms = 15mins)&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;900000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Update the class to reflect snooziness&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;setSnoozeContents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;localStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nonews_snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Human readable amount of time left in snooze period&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snoozeTimeRemaining&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;secs_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;secs_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;secs_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; seconds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;mins_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;secs_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;unit_of_measure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mins_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; minute&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; minutes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mins_remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;unit_of_measure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Updates the snooze container with proper html to operate snooze bar&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setSnoozeContents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;span class=&amp;quot;snoozing&amp;quot;&amp;gt;NoNews is snoozing for  the next &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snoozeTimeRemaining&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snooze_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;lt;/span&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;button id=&amp;quot;nonews_snooze&amp;quot; href=&amp;quot;#&amp;quot;&amp;gt;Snooze NoNews Filtering for 15 Minutes&amp;lt;/button&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;snooze_container&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;innerHTML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This file is not nearly as important for the core functionality of the extension, so I’ll go over it in less detail.  This just handles the snooze functionality, more specifically: setting the snooze end time, and showing a snooze bar or a time remaining in a snooze cycle.&lt;/p&gt;

&lt;p&gt;First, we set timestamps for &lt;code&gt;now&lt;/code&gt;, and &lt;code&gt;snooze_end&lt;/code&gt;.  Next, we create the contents of the snooze bar area with the &lt;code&gt;setSnoozeContents()&lt;/code&gt; function.  This function fills the paragraph element with either a button that will be our snooze bar, or a reminder of how long is left in the current snooze cycle.&lt;/p&gt;

&lt;p&gt;We then add an event listener to the snooze bar, if it exists, that calls the &lt;code&gt;snooze()&lt;/code&gt; function on a click event.  First snooze checks to make sure it is not already snoozing, then sets the &lt;code&gt;localStorage.nonews_snooze_end&lt;/code&gt; variable to 15 minutes in the future, in milliseconds.  Once this has been set, the &lt;code&gt;setSnoozeContents()&lt;/code&gt; method is fired again, as the snooze bar needs to be replaced with the time remaining.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;snoozeTimeRemaining()&lt;/code&gt; function should be self-explanatory; it simply returns a human readable representation of time remaining until the snooze cycle is complete.&lt;/p&gt;

&lt;h2 id=&quot;whats-next&quot;&gt;What’s next?&lt;/h2&gt;

&lt;p&gt;This project is still in its infancy.  I hope.  I am using it now, and it is serving me well.  I would like to see some additional features, like an options page that allows the blacklist to be manipulated, or safe times to be set where the extension is automatically snoozed during certain times.  I’ve thought about adding importing and exporting of blacklists, custom whitelists, and custom redirect pages.  The list goes on.&lt;/p&gt;

&lt;p&gt;I don’t have to be the creator of all these new features.  The &lt;a href=&quot;https://github.com/JDStraughan/nonews&quot;&gt;NoNews extension is open-source&lt;/a&gt;, and all pull requests will be considered for inclusion.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;With a little bit of javascript, some time to delve into the documentation, and some experimentation, creating a browser extension can be a fun and rewarding process.  This extension is a very simplistic one, yet it served as a good introduction to how these things are constructed.&lt;/p&gt;

&lt;p&gt;Paying attention to the permissions in the manifest file and exploring different aspects of the API was the key for me when poking around with the idea of making this extension.  I tried a few different ways to accomplish this task, and had fun breaking things and getting them all right again.  I hope this guide helps you in your browser extension adventures, and please leave any constructive criticism, improvements, or questions in the comments section below.&lt;/p&gt;
</description>
        <pubDate>Thu, 07 Feb 2013 00:00:00 -0600</pubDate>
        <link>http://jdstraughan.com/2013/02/07/nonews-part-2-the-source</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/02/07/nonews-part-2-the-source</guid>
        
        <category>chrome extension</category>
        
        <category>javascript</category>
        
        
      </item>
    
      <item>
        <title>NoNews (is Good News!)</title>
        <description>&lt;p&gt;No news, as the title and aphorism declare, is often good news.  Like many internet users, reading the news online has become a passive activity for me. I find myself checking news sites when I have 30 seconds to kill, for no reason in particular.  When the actual news airs on television, on the few occasions when I happen to catch it, I find myself secretly enjoying that I am so “plugged in” the news is ancient history by the time the TV gets ahold of it.&lt;/p&gt;

&lt;p&gt;I read it all: &lt;a href=&quot;http://www.huffingtonpost.com/&quot;&gt;HuffPo&lt;/a&gt; to &lt;a href=&quot;http://drudgereport.com&quot;&gt;Drudge&lt;/a&gt;, &lt;a href=&quot;http://www.aljazeera.com&quot;&gt;Al Jazeera&lt;/a&gt; to &lt;a href=&quot;http://www.haaretz.com&quot;&gt;Haaretz&lt;/a&gt;, &lt;a href=&quot;https://news.google.com&quot;&gt;Google News&lt;/a&gt; to &lt;a href=&quot;http://www.reddit.com/r/worldnews/&quot;&gt;/r/worldnews&lt;/a&gt;, and everything in between.  I don’t favor right wing or left, American or European, I read it all. It’s been so bad that I’ve even read &lt;a href=&quot;http://www.thesun.co.uk/&quot;&gt;British tabloids&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It is what I do.&lt;/p&gt;

&lt;p&gt;Rather, it is what I did.&lt;/p&gt;

&lt;p&gt;In one of my recent news binges - sometimes they last hours - I had read the tragic story of &lt;a href=&quot;http://en.wikipedia.org/wiki/Aaron_Swartz&quot;&gt;Aaron Swartz&lt;/a&gt;, a story that ends with a young man taking his own life.  I had never met this man, nor did I know much about him, but the articles touted him as a co-founder of one of my favorite hangouts on the internet: &lt;a href=&quot;http://www.reddit.com&quot;&gt;reddit&lt;/a&gt;.  I don’t want to delve too far into his story here, but I would encourage you to research it if you are not familiar with it already.  I do, however, want to talk about one essay I stumbled across while feeding my news binge with every thing I could learn about this troubled young man.&lt;/p&gt;

&lt;p&gt;The essay I read was: &lt;a href=&quot;http://www.aaronsw.com/weblog/hatethenews&quot;&gt;I Hate the News&lt;/a&gt;, a piece Aaron had written in October of 2006.&lt;/p&gt;

&lt;p&gt;It hit me in the gut.&lt;/p&gt;

&lt;p&gt;While the entire essay is worth reading, multiple times, things really started to hit home when he began to persuade that the news is actually harmful, if by no other means than wasting my time.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;With the time people waste reading a newspaper every day, they could have read an entire book about most subjects covered and thereby learned about it with far more detail and far more impact than the daily doses they get dribbled out by the paper. But people, of course, wouldn’t read a book about most subjects covered in the paper, because most of them are simply irrelevant.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Another way to look at this would be: if I replaced the time I waste everyday reading about inconsequential things and instead spent that time learning, I could greatly impact my life with new knowledge.  Instead of reading about some politician’s errant tweets on CNN, I could be learning about &lt;a href=&quot;http://ocw.mit.edu/courses/mechanical-engineering/2-016-hydrodynamics-13-012-fall-2005/&quot;&gt;hydrodynamics&lt;/a&gt;.  Well, maybe.&lt;/p&gt;

&lt;p&gt;Reading the news everyday does not make me a better human. It does not make me a happier one, either.  The news is depressing, and it is that way by design.  We like reading about homicides, thefts, wars, and riots; if we did not, they would not print it.  Aaron continues:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The news’s obsession with having a little bit of information on a wide variety of subjects means that it actually gets most of those subjects wrong. (One need only read the blatant errors reported in the corrections page to get some sense of the more thorough-going errors that must lie beneath them. And, indeed, anyone who has ever been in the news will tell you that the news always gets the story wrong.) Its obsession with the criminal and the deviant makes us less trusting people. Its obsession with the hurry of the day-to-day makes us less reflective thinkers. Its obsession with surfaces makes us shallow.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Subjecting myself to hours of tiny morsels of psuedo-facts dipped in sociopathic hollandaise is no way to live.  I am not saying all news is bad news, but after thinking about this for a while, it is obvious I could cut back. The news does not help my creativity, happiness, health, wellness, or mental stability.  Instead of being a passive activity, confronting the news should have a time and place.&lt;/p&gt;

&lt;p&gt;Enter &lt;a href=&quot;http://www.nonews.info&quot;&gt;NoNews&lt;/a&gt; - the browser extension to save my (and your) happiness.&lt;/p&gt;

&lt;p&gt;I’ve flirted with the idea of creating a browser extension for Google Chrome for quite some time.  After realizing my new found desire to avoid reading news sites would directly clash with my lack of will power, I decided to do what any lazy programmer would do: make some software to do it for me!&lt;/p&gt;

&lt;p&gt;Once installed, NoNews filters the sites visited by your browser, and issues a warning page whenever you attempt to view a news site.  For me, passive browsing has introduced me to countless depressing stories that have little direct impact on my life - I just click, read, rinse, and repeat.  NoNews is designed to break this vicious cycle, reminding the user that this behavior is potentially harmful.&lt;/p&gt;

&lt;p&gt;Recognizing that not all news is bad news, or unavoidable, I did include a couple of overrides.  First of all, every warning page has the ability to continue on to the news source using a one time pass.  The other option is the &lt;a href=&quot;http://www.nonews.info/how-to-snooze.html&quot;&gt;snooze bar&lt;/a&gt;, which disables the NoNews filter for 15 minutes, allowing unbridled access to all the news that is news.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/post/nonews-blocked-site-screen-800.jpg&quot; alt=&quot;Nonews Blocked Site Screen&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Screenshot of blocked URL with red bypass button and snooze bar popup open.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Just like the news, NoNews is free.  Unlike the news, I hope it makes you happy.  You can get &lt;a href=&quot;https://chrome.google.com/webstore/detail/no-news-is-good-news/fnikidjfogfllkinoahanihoddalbhil&quot;&gt;NoNews in the Google Chrome Web Store&lt;/a&gt; (free), or check out the &lt;a href=&quot;https://github.com/JDStraughan/nonews&quot;&gt;source code on GitHub&lt;/a&gt;.  If you are a developer, stay tuned, the next blog post is (planned to be) all about the NoNews source code.&lt;/p&gt;

&lt;p&gt;For what it’s worth, I can leave you with a final adage: &lt;a href=&quot;http://en.wikipedia.org/wiki/Eating_your_own_dog_food&quot;&gt;I’m eating my own dog food&lt;/a&gt;.  For the past couple of weeks I have been leaving NoNews activated in my browser while I have been developing it on the side. I really expected this project to be a learning experience in building browser extensions, and not really yield a product I would use.  I picked the news blocker as a way to create something small, open source, and meaningful as a tribute to someone who contributed so much to the online world I sometimes take for granted.  What I have found is that using NoNews actually works for me, and I plan to leave it on and installed.  I now pick and choose my news more carefully, and limit the amount of time I spend reading about the latest war, riot, or scandal.  I think it has contributed to my overall happiness, productivity, and focus - I hope it does for you also.&lt;/p&gt;
</description>
        <pubDate>Tue, 29 Jan 2013 00:00:00 -0600</pubDate>
        <link>http://jdstraughan.com/2013/01/29/nonews-is-good-news</link>
        <guid isPermaLink="true">http://jdstraughan.com/2013/01/29/nonews-is-good-news</guid>
        
        <category>chrome extension</category>
        
        <category>javascript</category>
        
        
      </item>
    
  </channel>
</rss>
